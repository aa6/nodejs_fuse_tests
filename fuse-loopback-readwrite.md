[`fuse-loopback-readwrite`](/fuse-loopback-readwrite.coffee) is a moderate-featured loopback linux-only filesystem implementation for a Node.js [`fuse-bindings`](https://github.com/mafintosh/fuse-bindings) package. It consists of 20 functions. The functions are not binded upon mounting into some class instance and `this` by default points to a higher context, usually to `global`.

This text is backed and generated by [the test in `spec` folder](/spec/fuse-loopback-readwrite.spec.coffee)

### init(cb)
Called on filesystem initialization, prior to all other functions. Called only one time per each mount. Always accepts only one input argument.

**Parameters:**  
`cb` Callback to call after the function done it's work.

**Return:**  
Init doesn't return any values and would NOT raise any errors or exceptions if you'll pass an error code to the `cb` as an argument.

### getattr(path, cb)
Called when a path is being stat'ed. Getattr call always precede all `readdir` calls.

**Parameters:**  
`path` Path to a file within the FUSE filesystem. Path always starts with a directory separator (slash).  
`cb` Callback to call after the function done it's work.

**Return:**  
Returns values by calling the `cb(error_code, stat_data)` callback. `error_code` equal to `0` means no errors. `stat_data` is an object similar to the one returned in node's `fs.stat(path, cb)` and must contain next properties:

`mtime`: <Date object>. Modification time. Indicates the time the contents of the file has been changed. Only the contents. Not the attributes. For instance, if you open a file and change some (or all) of its content, its mtime gets updated. If you change a file's attribute (like read-write permissions, metadata), its mtime doesn't change, but ctime will.

`atime`: <Date object>. Access time. Indicates the time that a file has been accessed. Any operation performed on the file changes access time.

`ctime`: <Date object>. Change time. Whenever anything about a file changes (except its access time), its ctime changes.

`size`: <Int>. Size in bytes. As long as directory is just a special type of file which contains list of names and inodes, the concept of size is also applicable to it and the directory size implies the size of the directory file itself and not the number of items in the list or something else.

`mode`: <Int>. Mode flags. A bit field containing file type, file access (SUID/SGID) and file permissions flags. The flags can be obtained through Node.js `require('constants')` module. Flags values are defined in `stat.h` linux header file. Most common flags are:

Constant name | Binary value | Description
------------- | ------------ | -----------
`S_IFMT`   | 0b1111000000000000 | Bitmask for the filetype bitfield. (mask for filetype)
`S_IFSOCK` | 0b1100000000000000 | Filetype constant of a socket.
`S_IFLNK`  | 0b1010000000000000 | Filetype constant of a symbolic link.
`S_IFREG`  | 0b1000000000000000 | Filetype constant of a regular file.
`S_IFBLK`  | 0b0110000000000000 | Filetype constant of a block device.
`S_IFDIR`  | 0b0100000000000000 | Filetype constant of a directory.
`S_IFCHR`  | 0b0010000000000000 | Filetype constant of a character device.
`S_IFIFO`  | 0b0001000000000000 | Filetype constant of a FIFO named pipe.
`S_ISUID`  | 0b0000100000000000 | SUID (set-user-ID on execution) bitmask.
`S_ISGID`  | 0b0000010000000000 | SGID (set-group-ID on execution) bitmask.
`S_ISVTX`  | 0b0000001000000000 | Sticky bit bitmask.
`S_IRWXU`  | 0b0000000111000000 | Owner permissions bitmask.
`S_IRUSR`  | 0b0000000100000000 | Owner permission to read bitmask.
`S_IWUSR`  | 0b0000000010000000 | Owner permission to write bitmask.
`S_IXUSR`  | 0b0000000001000000 | Owner permission to execute bitmask.
`S_IRWXG`  | 0b0000000000111000 | Group permissions bitmask.
`S_IRGRP`  | 0b0000000000100000 | Group permission to read bitmask.
`S_IWGRP`  | 0b0000000000010000 | Group permission to write bitmask.
`S_IXGRP`  | 0b0000000000001000 | Group permission to execute bitmask.
`S_IRWXO`  | 0b0000000000000111 | Others permissions bitmask.
`S_IROTH`  | 0b0000000000000100 | Others permission to read bitmask.
`S_IWOTH`  | 0b0000000000000010 | Others permission to write bitmask.
`S_IXOTH`  | 0b0000000000000001 | Others permission to execute bitmask.

`uid`: <Int>. File owner identifier (UID). A unique positive integer assigned by an operating system to each user. Each user is identified to the system by its UID, and user names are generally used only as an interface for humans.  
The Linux Standard Base Core Specification specifies that UID values in the range 0 to 99 should be statically allocated by the system, and shall not be created by applications, while UIDs from 100 to 499 should be reserved for dynamic allocation by system administrators and post install scripts.  
On FreeBSD, porters who need a UID for their package can pick a free one from the range 50 to 999 and then register this static allocation in ports/UIDs. Some POSIX systems allocate UIDs for new users starting from 500 (OS X, Red Hat Enterprise Linux), others start at 1000 (openSUSE, Debian[6]). On many Linux systems, these ranges are specified in `/etc/login.defs`, for `useradd` and similar tools.  
Central UID allocations in enterprise networks (e.g., via LDAP and NFS servers) may limit themselves to using only UID numbers well above 1000, to avoid potential conflicts with UIDs locally allocated on client computers. NFSv4 can help avoid numeric identifier collisions, by identifying users (and groups) in protocol packets using "user@domain" names rather than integer numbers, at the expense of additional translation steps.

`gid`: <Int>. File owner group identifier (GID). A unique positive integer assigned by an operating system to each group. Each group is identified to the system by its GID, and group names are generally used only as an interface for humans. Many Linux systems reserve the GID number range 0 to 99 for statically allocated groups, and either 100−499 or 100−999 for groups dynamically allocated by the system in post-installation scripts. These ranges are often specified in `/etc/login.defs`, for `useradd`, `groupadd` and similar tools.

### readdir(path, cb)
Called when a directory is being listed. Always accepts only two input arguments. Always preceded with a `gettattr` call. Readdir is not called if the `path` entry wasn't listed by parent directory readdir call or preceding `getattr` returned an error (in common - if the entry doesn't exists). However it is possible to simulate the situation when `readdir` is called on a nonexistant entry but in that case error is ignored (possible bug) and `entries_array` is returned instead.

**Parameters:**  
`path` Path to a file within the FUSE filesystem. Path always starts with a directory separator (slash).  
`cb` Callback to call after the function done it's work.

**Return:**  
Returns values by `cb(error_code, entries_array)` callback. `entries_array` is an array of strings of entries names which requested `path` contains. Readdir will return empty array if `entries_array` passed to `cb` is null or undefined.